# ShinePet

一个可爱、可拖拽的浏览器插件电子宠物。它会在你的屏幕上跳舞、做动作，陪你写代码、刷网页、学习充电。

> 状态：规划与原型阶段。本文档先明确产品目标、交互与开发计划，便于后续实现与协作。

## 功能特性（目标）

- 可爱常驻：在网页上以悬浮层形式出现，不遮挡主要内容
- 自由拖动：按住即可拖拽，靠近屏幕边缘自动吸附
- 动作系统：待机、挥手、跳舞、打招呼、睡觉等可切换动作
- 互动触发：点击/双击/长按触发不同动画；可随机卖萌
- 物理与边界：简单重力/落地/边缘反弹（按需开启）
- 音效与静音：部分动作配音效，支持一键静音
- 个性化：大小、透明度、层级、皮肤可配置
- 轻量稳定：不影响页面性能，低 CPU/GPU 占用

## 预览

（占位：在此放置 GIF 或截图，例如 `docs/demo.gif`）

## 安装

当前处于开发阶段，推荐以“加载已解压的扩展”方式安装：

1. 克隆项目：
   ```bash
   git clone https://github.com/<your-org-or-name>/ShinePet.git
   ```
2. 在浏览器中打开扩展页面：
   - Chrome/Edge：地址栏输入 `chrome://extensions/` 或 `edge://extensions/`
   - 打开“开发者模式” → “加载已解压的扩展程序” → 选择项目根目录（含 `manifest.json`）

发布版将提供商店地址与一键安装方式。

## 使用方式（交互设计）

- 拖动：按住宠物即可拖拽，靠近屏幕边缘会吸附停靠
- 单击：切换到下一个轻量动作（如挥手）
- 双击：触发跳舞等高能量动作（带可选音效）
- 右键：打开快捷菜单（天气开关、立即刷新、自动定位、设置城市）
- 休息：拖到页面底部停留可进入“睡觉”状态
- 持久化：位置、大小、音量等会在 `chrome.storage.sync` 中保存

## 权限与安全

计划申请（以 MV3 为准，最终以实现为准）：

- `storage`：保存用户设置与宠物状态
- `scripting`：向页面注入悬浮层（内容脚本/脚本 API）
- `activeTab`（可选）：在当前活动页快速启用/禁用
- `geolocation`（仅浏览器提示授权时使用）：获取当前位置用于天气
- `contextMenus`（不使用扩展级 API，改为页面内自定义右键菜单）
- `alarms`（未使用）：当前以页面内 `setInterval` 实现 2 小时刷新

本扩展不收集个人敏感信息，所有数据保存在本机或同步到用户浏览器账户。

## 自定义与扩展（规划）

- 皮肤与素材：
  - 路径结构示例：`/assets/pets/<pet-id>/sprite.png`、`/assets/pets/<pet-id>/config.json`
  - `config.json` 中定义动作名称、帧率、帧序列、碰撞盒、音效绑定等
  - 简单皮肤切换：当前实现将优先加载 `assets/pikachu.svg`，若不存在则回退到 `assets/pet.svg`
- 行为配置：
  - 通过 `behaviors.json`（或等价模块）声明可用动作与触发条件
- 设置面板：
  - 尺寸、透明度、层级、吸附开关、随机卖萌频率、音量

## 技术方案（拟定）

- Manifest V3 浏览器扩展
- TypeScript + 轻量渲染（Canvas/CSS Sprite）
- 构建：Vite 或等效工具产出 `dist`
- 质量保障：ESLint、Prettier

### 天气实现说明

- 天气来源：Open‑Meteo `https://api.open-meteo.com/` 与地理编码 `https://geocoding-api.open-meteo.com/`
- 刷新频率：每 2 小时自动刷新；可在右键菜单中“立即刷新”
- 定位优先级：手动设置城市 > 浏览器定位 > 不显示
- 数据缓存：`chrome.storage.sync` 持久化最近一次天气与时间戳
- 徽标显示：在宠物右上角展示表情 + 温度（如 `☀️ 26°C`）

最终选型将以实现阶段的约束与性能为准，README 会同步更新。

## 目录结构

```
ShinePet/
  ├─ assets/                  # 宠物素材与配置（pet.svg 等）
  ├─ src/                     # 源码（内容脚本、样式等）
  │   ├─ content.js
  │   └─ content.css
  ├─ manifest.json            # MV3 清单
  ├─ README.md
  └─ LICENSE
```

## 开发指南（将随实现补充）

当前阶段无需构建，直接在浏览器扩展页面加载项目根目录进行调试。后续将引入工具链（如 Vite + TS）并更新命令：

1. 直接加载根目录（包含 `manifest.json`）调试内容脚本效果
2. 修改 `src/content.js` 与 `src/content.css` 可立即生效（刷新页面/扩展）
3. 引入构建后将提供 `dev`/`build` 命令与更完善的目录结构

## 路线图

- v0.1 原型：基础悬浮层、拖拽、两三个动作、位置持久化
- v0.2 互动：点击/双击触发、快捷菜单、静音与缩放
- v0.3 个性化：换肤与动作配置、吸附/物理开关
- v0.4 增强：节奏跳舞（跟随音乐/系统音）、定时提醒、更多动作
- v1.0 发布：性能优化、适配主流 Chromium 浏览器与商店上架

## 贡献

欢迎 Issue 与 PR。请遵循 Conventional Commits（如 `feat:`、`fix:`、`docs:` 等），并确保通过基础校验（Lint/Build）。

## 许可

本项目使用 MIT License，详见 `LICENSE`。

